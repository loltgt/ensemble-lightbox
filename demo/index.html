<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ensemble Lightbox demo</title>
<link rel="stylesheet" href="../../ensemble-lightbox/dist/css/ensemble-lightbox.css">
<link rel="stylesheet" href="demo-ensemble-lightbox.css">
</head>
<body>
<main>
<h1>ensemble Lightbox demo</h1>

<section>
<h2>ensemble.Lightbox</h2>

<div class="grid">
<figure>
<a href="image-test-28231.jpg">
    <img src="image-test-28231.jpg" alt="caption from img[alt]">
</a>
</figure>

<figure>
<a href="image-test-109054.jpeg" title="caption from a[title]">
    <img src="image-test-109054.jpeg">
</a>
</figure>

<figure>
<a href="iframe-test-demo-lightbox.html" data-caption="iframe"></a>
</figure>

<figure>
<a href="image-test-821573.png">
    <img src="image-test-821573.png" alt="caption from img[alt]">
</a>
</figure>

<figure>
<a href="image-test-demo-lightbox-image008.jpg">
    <img src="image-test-demo-lightbox-image008.jpg" data-caption="caption from img[data-caption]">
</a>
</figure>

<figure>
    <a href="test-pdf-document.pdf" data-caption="pdf"></a>
</figure>

<figure>
<a href="image-test.gif" data-caption="animated gif">
    <img src="image-test.gif">
</a>
</figure>

<figure>
<a href="data:image/svg+xml;base64,PHN2ZyBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjIiIHZpZXdCb3g9IjAgMCA2MDAgNjAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im0wIDBoNjAwdjYwMGgtNjAweiIgZmlsbD0iI2NhYzBjYSIvPjxwYXRoIGQ9Im01OS45OTk5OCA4MGgxOTkuOTk5OTh2MTk5Ljk5OTk4aC0xOTkuOTk5OTh6IiBmaWxsPSIjNTAzYjhkIiBzdHJva2Utd2lkdGg9Ii44MzY4MiIvPjxjaXJjbGUgY3g9IjMwMC4wMDAzOCIgY3k9IjMwNS4wMDAxNCIgZmlsbD0iIzc3M2M4YyIgcj0iMTM1LjAwMDA2IiBzdHJva2Utd2lkdGg9IjEuMjIxNzIiLz48cGF0aCBkPSJtMzM5LjUgMjM1IDE0Mi41IDI4NWgtMjg1eiIgZmlsbD0iIzMwM2U3NyIgdHJhbnNmb3JtPSJtYXRyaXgoMS4yNjMxNiAwIDAgMS4wMTc1NCAtNjguODQyMSAxMC44NzcyKSIvPjwvc3ZnPg==" data-caption="inline svg">
    <img src="data:image/svg+xml,%3Csvg clip-rule='evenodd' fill-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2' viewBox='0 0 600 600' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m0 0h600v600h-600z' fill='%23cac0ca'/%3E%3Cpath d='m59.99998 80h199.99998v199.99998h-199.99998z' fill='%23503b8d' stroke-width='.83682'/%3E%3Ccircle cx='300.00038' cy='305.00014' fill='%23773c8c' r='135.00006' stroke-width='1.22172'/%3E%3Cpath d='m339.5 235 142.5 285h-285z' fill='%23303e77' transform='matrix(1.26316 0 0 1.01754 -68.8421 10.8772)'/%3E%3C/svg%3E">
</a>
</figure>
</div>

<h3>Test <span>webp</span> and <span>avif</span> images with <span>infinite: false</span></h3>

<div class="grid">
<figure>
<a href="test-webp-image-126293.webp">
    <img src="test-webp-image-126293.webp" alt="image webp">
</a>
</figure>

<figure>
<a href="test-avif-image-1510592.avif">
    <img src="test-avif-image-1510592.avif" alt="image avif">
</a>
</figure>
</div>

<h3>Test with contents passed with options.</h3>

<div>
    <button id="button-lightbox">Open lightbox</button>
</div>
</section>

<section>
<h2>ensemble.Modal</h2>

<span class="content">Show this content in a modal.</span>

<button id="button-modal">Open modal</button>
</section>
</main>

<!-- <script src="../../ensemble/src/js/Compo.js"></script> -->
<!-- <script src="../../ensemble/src/js/Data.js"></script> -->
<!-- <script src="../../ensemble/src/js/Event.js"></script> -->
<!-- <script src="../../ensemble/src/js/base.js"></script> -->
<!-- <script src="../../ensemble-modal/src/js/Modal.js"></script> -->
<!-- <script src="../../ensemble-lightbox/src/js/Lightbox.js"></script> -->
<script src="../../ensemble-lightbox/dist/js/ensemble-lightbox.min.js"></script>
<script>
const g1 = document.querySelector('.grid:nth-child(n+3)');

for (const o of g1.querySelectorAll('img')) {
  const n = new Image();
  n.onerror = e => {
    o.parentElement.parentElement.remove();

    if (! g1.children.length) {
      g1.hidden = g1.previousElementSibling.hidden = true;
    }
  };
  n.src = o.src;
}


const modal_element = document.querySelector('.content');

const modal = new ensemble.Modal(modal_element, {});
const modal_button = document.getElementById('button-modal');
modal_button.addEventListener('click', modal.open, true);


const lightbox_grid = document.querySelectorAll('.grid');

for (const lightbox_group of lightbox_grid) {
  var lightbox_options = { selector: 'a' };

  if (lightbox_group === lightbox_grid[1]) {
    lightbox_options.infinite = false;
  }

  const lightbox = new ensemble.Lightbox(lightbox_group, lightbox_options);

  for (const a of lightbox_group.querySelectorAll('a')) {
    a.addEventListener('click', lightbox.open, true);
  }
}

const lightbox_contents = [
  {
    type: 'element',
    node: (function() {
      var el = document.createElement('div');
      el.innerText = 'Test for a custom element.';
      return el;
    }())
  },
  {
    type: 'video',
    loop: true,
    poster: 'video-test-card.png',
    sources: [
      {
        type: 'video/mp4',
        src: 'video-test-card.mp4'
      },
      {
        type: 'video/webm',
        src: 'video-test-card.webm'
      }
    ]
  },
  {
    type: 'video',
    src: 'https://www.youtube.com/embed/mN0zPOpADL4',
    caption: 'Agent 327: Operation Barbershop\n\nfrom Blender Studio',
    allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture',
    allowfullscreen: true //TODO FIX
  },
  {
    type: 'video',
    src: 'https://player.vimeo.com/video/325910798',
    caption: 'Spring - Blender Open Movie\n\nfrom Blender Studio',
    allow: 'autoplay; fullscreen; picture-in-picture',
    allowfullscreen: true //TODO FIX
  },
  {
    type: 'audio',
    src: 'https://open.spotify.com/embed/album/54Awn36ryf55PkZyOR4iwQ',
    allowtransparency: true, //TODO FIX
    allow: 'encrypted-media'
  },
  {
    type: 'iframe',
    src: 'https://docs.google.com/forms/d/e/1FAIpQLSeI8_vYyaJgM7SJM4Y9AWfLq-tglWZh6yt7bEXEOJr_L-hV1A/viewform?formkey=dGx0b1ZrTnoyZDgtYXItMWVBdVlQQWc6MQ',
    height: '100%' //TODO FIX
  },
  {
    type: 'iframe',
    src: 'https://www.openstreetmap.org/export/embed.html?bbox=-5.888671875%2C34.397844946449865%2C25.532226562500004%2C48.951366470947725&amp;layer=mapnik'
  },
  {
    type: 'audio',
    src: 'audio-test.wav',
    autoplay: true
  }
];

const lightbox_button = document.getElementById('button-lightbox');
const lightbox = new ensemble.Lightbox({ backClose: false, contents: lightbox_contents });
lightbox_button.addEventListener('click', lightbox.open, true);
</script>
</body>
</html>
