/*!
 * ensemble Lightbox
 * @version 0.4.0
 * @link https://github.com/loltgt/ensemble-lightbox
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";const e=new Proxy({},{get:(t,e)=>t.lang&&t[t.lang][e]||e}),s="html|head|body|meta|link|style|script";class part{render(){delete this.element,delete this.render}bind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}place(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns,s=this[e];return!!s.insertBefore(t[e],s.firstElementChild||null)}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(!t instanceof Element||RegExp(s,"i").test(t.tagName)||RegExp(`(<(${s})*>)`,"i").test(t.innerHTML))throw new Error(e.EMTAG);return this.empty(),!!this[this.ns].appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){return Array.prototype.map.call(this[this.ns].children,(t=>t._1))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild._1:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild._1:null}}class Compo extends part{constructor(t,o,n,i,r,c){super();const a=this.ns=`_${t}`,h=o?o.toString():"div";if(RegExp(s,"i").test(h))throw new Error(e.ETAGN);const l=this[a]=this.element(t,h,n,i,r,c);if(this.__Compo=1,this[a]._1=this,i&&"object"==typeof i)for(const s in i){const o=s.toString();if(RegExp("attributes|classList|innerHTML|outerHTML|nodeName|nodeType").test(o))throw new Error(e.EPROP);if(0===o.indexOf("on")&&i[o]&&"function"==typeof i[o])l[o]=i[o].bind(this);else if("object"!=typeof i[o])l[o]=i[o];else if("children"==o&&"object"==typeof i[o]&&i[o].length)for(const e of i.children){const{tag:s,name:o,props:n}=e;this.append(new Compo(t,s,o,n))}}if(n){const e=l.className;l.className="","string"==typeof n?l.className=`${t}-${n}`:"object"==typeof n&&(l.className=Object.values(n).map((e=>`${t}-${e}`)).join(" ")),e&&(l.className+=` ${e}`)}this.render()}element(t,e,s,o,n,i){return i?document.createElementNS(i,e,n):document.createElement(e,n)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){return getComputedStyle(this[this.ns])[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return console.warn(e.DOM),this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&t.parentElement._1?t.parentElement._1:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling._1:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling._1:null}get classList(){return this[this.ns].classList}static isCompo(t){return t instanceof Compo}}class Data{constructor(t,e){e&&"object"==typeof e&&Object.assign(this,{},e);const s=this.ns=`_${t}`;this.__Data=0,this[s]={ns:t}}compo(t,e,s,o=!1,n=!1,i=!1){const r=this[this.ns].ns;let c;return c=o?{ns:r,tag:t,name:e,props:s,load:n,unload:i}:new Compo(r,t,e,s),n&&"function"==typeof n&&(c.load=s.onload=n),i&&"function"==typeof i&&(c.unload=s.onunload=i),c}async render(t){const e=this[this.ns],s=this;e[t]&&e[t]._||(e[t]={_:s[t],load:s[t].load,unload:s[t].unload},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].load()}async unload(t){const e=this[this.ns];e[t]&&e[t]._&&e[t].unload()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t]._.ns,s[t]._.name,s[t]._.props):s[t]&&s[t]._&&s[t].load()}static isData(t){return t instanceof Data}}class Event{constructor(t,e,s){const o=this.ns=`_${t}`;s=(Compo.isCompo(s)?s[t]:s)||document,this.__Event=0,this[o]={name:e,node:s}}add(t,e=!1){const{node:s,name:o}=this[this.ns];s.addEventListener(o,t,e)}remove(t){const{node:e,name:s}=this[this.ns];e.removeEventListener(s,t)}static prevent(t){t.preventDefault()}static focus(t,e){const{currentTarget:s}=t;s.focus&&s.focus(e)}static blur(t,e=100){const{currentTarget:s}=t;setTimeout((()=>s.blur&&s.blur()),e)}static isEvent(t){return t instanceof Event}}class base{constructor(){const t=arguments;let s,o;if(t.length>1?(s=t[0],o=t[1]):t[0]&&"object"==typeof t[0]&&t[0].nodeType?s=t[0]:o=t[0],o&&"object"!=typeof o)throw new TypeError(e.EOPTS);if(s&&"object"!=typeof s)throw new TypeError(e.EELEM);this.binds(),this.options=this.opts(this.defaults(),o),Object.freeze(this.options),this.element=s}opts(t,e={}){const s={};for(const o in t)null!=t[o]&&"object"==typeof t[o]?s[o]=Object.assign(t[o],e[o]):s[o]=void 0!==e[o]?e[o]:t[o];return s}compo(t,e,s){const o=this.options.ns;return null!=t?new Compo(o,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){const s=this.options.ns;return null!=t?new Event(s,t,e):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}icon(t,e,s,o,n,i){const r=this.options.ns,c=s?`${s}-${e}`:e,a=this.compo("span","icon",{className:c});if("font"!=t)if("symbol"==t||"shape"==t){const e="http://www.w3.org/2000/svg",s=new Compo(r,"svg",!1,!1,null,e),c="symbol"==t?"use":"path",h=new Compo(r,c,!1,!1,null,e);if(i){const t=i.match(/\d+ \d+ (\d+) (\d+)/);t&&Object.entries({width:t[1],height:t[2],viewBox:t[0]}).forEach((t=>s.setAttr(t[0],t[1])))}"use"==c?h.setAttr("href",`#${n}`):h.setAttr("d",o),s.append(h),a.append(s)}else if("svg"==t&&this.origin()){const t=this.compo(r,"img",!1,{src:`${o}#${n}`});a.append(t)}return a}origin(t,e){return e=URL.canParse(e)?e:"null"!=window.origin?window.origin:window.location.origin,t=URL.canParse(t)?new URL(t).origin:e,e&&t&&e===t}cst(t,e){let s=Compo.isCompo(t)?t.getStyle(e):getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}delay(t,e,s){const o=e?this.cst(e,"transitionDuration"):0;setTimeout(t,o||s)}wrap(t){const s=this;if(this[t]&&"function"!=typeof t)throw new TypeError(e.EMETH);return function(){t.call(s,...arguments,this)}}}class Modal extends base{defaults(){return{ns:"modal",root:"body",className:"modal",dialog:!0,modal:!0,window:!1,icons:{type:"shape",prefix:"icon"},effects:!0,clone:!0,backdrop:!0,keyboard:!0,close:{trigger:this.close,text:"Ã—",icon:"m20 4-8 8 8 8-8-8-8 8 8-8-8-8 8 8 8-8Z",viewBox:"0 0 24 24"},locale:{close:"Close"},onOpen:()=>{},onClose:()=>{},onShow:()=>{},onHide:()=>{},onContent:()=>{},onInit:()=>{},onResume:()=>{}}}binds(){this.open=this.wrap(this.open),this.close=this.wrap(this.close),this.backdrop=this.wrap(this.backdrop),this.keyboard=this.wrap(this.keyboard)}constructor(){super(...arguments)}init(t){const e=this.element;if(!e)return;this.layout();const s=this.$=this.content(e);this.stage.append(s),this.options.onInit.call(this,this,t)}resume(t){this.options.onResume.call(this,this,t)}layout(){const t=this.options,e=this.modal=this.data({onclick:!1}),s=this.modal.$=this.compo(!!t.dialog&&"dialog",!1,{className:"object"==typeof t.className?Object.values(t.className).join(" "):t.className,hidden:!0,onclick:function(){e.onclick&&"function"==typeof e.onclick&&e.onclick.apply(this,arguments)}}),o=this.modal.body=this.compo(!1,"body"),n=this.stage=this.compo(!1,"stage"),i=this.nav=this.data(!0),r="close",{close:c,icons:a,locale:h}=t,l=i[r]=this.compo("button",["button",r],{onclick:c.trigger,innerText:"text"==a.type?c.text:"",ariaLabel:h.close});if("text"!=a.type){const{type:t,prefix:e,src:s,viewBox:o}=a,{icon:n,viewBox:i}=c,h=this.icon(t,"font"==t?n:r,e,s??n,n??r,i??o),d=h.first;d.setAttr("stroke","currentColor"),d.setAttr("stroke-width","2px"),l.append(h)}o.append(n),o.append(l),s.append(o),t.window&&s.classList.add(`${t.ns}-window`),t.backdrop&&(s.classList.add(`${t.ns}-backdrop`),e.onclick=this.backdrop),t.effects&&s.classList.add(`${t.ns}-effects`),this.root=this.selector(t.root),this.built=!0}content(t,e){const s=this.options,o=this.compo(!1,"content");let n=(e=e??s.clone)?this.cloneNode(t,!0):t;return s.onContent.call(this,this,o,n),n&&o.fill(n),o}open(t,e){if(this.event().prevent(t),this.opened)return;const s=this.options;this.built?this.resume(e):this.init(e),this.opened=!0,s.onOpen.call(this,this,e,t),this.show(e),s.keyboard&&this.event("keydown").add(this.keyboard),this.event().blur(t)}close(t,e){if(this.event().prevent(t),!this.opened)return;const s=this.options;this.opened=!1,s.onClose.call(this,this,e,t),this.hide(e),s.keyboard&&this.event("keydown").remove(this.keyboard),this.event().blur(t)}show(t){const{options:e,root:s}=this,o=this.modal.$,n=o.ns,i=o[n],r=this;o.bind(s),this.target=t,this.delay((()=>{if(e.dialog)try{e.modal?i.showModal():i.show(),i.focus()}catch(t){o.setAttr("open","")}else{const t=this.selector("button",i);t&&(t.focus(),t.blur())}o.show(),e.onShow.call(r,r,t)}))}hide(t){const{options:e,root:s}=this,o=this.modal.$,n=o.ns,i=o[n],r=this;if(o.hide(),e.dialog)try{i.close()}catch(t){o.delAttr("open")}else this.target&&this.target.focus();const c=document;c.hasFocus()&&c.activeElement.blur(),this.delay((()=>{o.unbind(s),e.onHide.call(r,r,t)}),o,300)}backdrop(t){this.event().prevent(t);const e=this.options,s=t.target,o=new RegExp(`${e.ns}-backdrop`);(o.test(s.className)||o.test(s.parentElement.className))&&this.close(t)}keyboard(t){if(27===t.keyCode)this.event().prevent(t),this.close(t)}}t.Lightbox=class Lightbox extends Modal{defaults(){return Object.assign(super.defaults(),{className:["modal","modal-lightbox"],modal:!1,icons:{type:"shape",prefix:"icon",autoDir:!0},selector:"",contents:null,backdrop:!1,touch:!0,mouse:!0,controls:!0,caption:!0,infinite:!0,autoDiscover:!0,autoHide:"controls",overlay:!1,checkOrigin:!0,prev:{trigger:this.prev,text:"<",icon:"m5 12 9 10-9-10 9-10-9 10Z",viewBox:"0 0 18 24"},next:{trigger:this.next,text:">",icon:"M14 12 4 22l10-10L4 2l10 10Z",viewBox:"0 0 18 24"},locale:{close:"Close",prev:"Previous",next:"Next"},onStep:()=>{},onSlide:()=>{},onCaption:()=>{}})}binds(){super.binds(),this.add=this.wrap(this.add),this.remove=this.wrap(this.remove),this.prev=this.wrap(this.prev),this.next=this.wrap(this.next),this.route=this.wrap(this.route)}constructor(){super(...arguments)}init(t){const{options:e,element:s}=this;let o;this.layout(),e.contents&&"object"==typeof e.contents?o=e.contents:e.selector&&s&&(o=this.selector(e.selector,s,!0)),o=this.contents=this.prepare(o);for(const e of o){const s=this.content(e);t&&t===s.ref&&(this.index=o.indexOf(s),this.current=s),this.$.append(s.$)}this.step(0),e.controls&&this.controls(),e.caption&&this.caption(),e.onInit.call(this,this,t)}resume(t){const{options:e,contents:s,current:o}=this;o.$.remove(o.inner);for(const e of s)t&&t===e.ref&&(this.index=s.indexOf(e),this.current=e);this.step(0),e.controls&&this.dir!=this.bidi&&this.arrows(),e.controls&&this.controls(),e.caption&&this.caption(),e.onResume.call(this,this,t)}layout(){super.layout();const{$:t,body:e}=this.modal,{stage:s,options:o,nav:n}=this;this.bidi=this.dir;let i=null;if(o.touch||o.mouse){const t=this.pointers();i={...o.touch&&{ontouchstart:t.hit,ontouchend:t.drop,ontouchover:t.drop,ontouchcancel:t.nil},...o.mouse&&{onmousedown:t.hit,onmouseup:t.drop,onmousecancel:t.nil}}}const r=this.$=this.compo(!1,"content",i);if(s.append(r),o.controls&&(n.$=this.compo("nav","nav"),this.arrows()),o.caption){var c=this.heading=this.data(!0);c.$=this.compo(!1,"caption")}const a=/caption|controls/;if(o.overlay){const e=o.overlay.toString().match(a);t.classList.add(`${o.ns}-overlay`),e&&t.classList.add(`${o.ns}-overlay-${e[0]}`)}if(o.autoHide){const e=o.autoHide.toString().match(a);t.classList.add(`${o.ns}-autohide`),e&&t.classList.add(`${o.ns}-autohide-${e[0]}`)}o.controls&&e.append(n.$),o.caption&&e.append(c.$)}content(t,e){const s=this.options,o=this.compo(!1,"object");let n;o.hide(),"string"==typeof t?n=this.data({source:t}):this.data().isData(t)&&(n=t);const i=n.src,r=n.type;let c=n.type;c&&(c=c.match(/(^image|video|audio)|(pdf$)/),c=c?c[0]:"");const a=/^https?:\/\//.test(i);let h,l=!1;if(s.autoDiscover&&i&&!c&&(/\.jpg|\.jpeg|\.png|\.apng|\.gif|\.webp|\.avif|\.bmp|\.svg$/i.test(i)?c="image":/\.pdf$/.test(i)?c="pdf":/\.mp4|\.webm|\.ogv|\.m4v|\.hevc|\.ivf|\.obu|\.ismv|\.mkv$/i.test(i)?c="video":/\.mp3|\.opus|\.ogg|\.m4a|\.aac|\.flac|\.wav|\.weba|\.mka$/i.test(i)?c="audio":/^data:image\/jpeg|png|apng|gif|webp|avif|bmp|svg\+xml/.test(i)&&(l=!0,c="image")),"pdf"==c&&(c="iframe",h="pdf"),s.checkOrigin&&i&&a&&!l&&!this.origin(i)&&(c=""),i&&!c)if("#"==i[0]){const t=this.selector(i);t&&(n.node=t,c=/iframe|img|picture|video|audio/i.test(t.nodeName)?/img|picture/i.test(t.nodeName)?"image":t.nodeName.toLowerCase():"element")}else c="iframe";"element"==c&&(e=e??s.clone,n.node=e?this.cloneNode(n.node,!0):n.node),h||r==c||(h=r),n.ref=n.ref||null,n.type=c,n.src=i;const d=n.ref;let u,m,f=n.caption;if(s.selector&&d)if(this.hasAttr(d,"title"))m=this.getAttr(d,"title");else if("image"==n.type){const t=this.selector("img",d);t&&(u=t.alt)}n.caption=f||m||u,"image"==n.type&&(n.alt=u||f.replace(/\n/g," ")),s.onContent.call(this,this,n),c&&o.classList.add(`${s.ns}-${c}`),h&&o.classList.add(`${s.ns}-${h}`);const g=this.inner(n);return n.load=()=>{n.node&&n.inner.fill(n.node),n.$.show()},n.unload=()=>{n.node&&n.inner.empty(),n.$.hide()},n.$=o,n.inner=n.compo(g.tag,g.name,g.props,!0,n.load,n.unload),n}inner(t){let e=t.type,s=!1,o={};for(const e in t)/ref|src|type|sources|subtitles|children/.test(e)||"_"==e[0]||(o[e]=t[e]);switch(t.src&&(o.src=t.src),t.type){case"image":if(e="img",t.sources||t.children)if(e="picture",o.children=[],t.sources&&"object"==typeof t.source)for(const e of t.sources)o.children.push({tag:"source",name:!1,props:e});else if(t.children&&t.children.length)for(const e of t.children){const t=e.tagName.toLowerCase();"source"==t&&"img"==t&&o.children.push({tag:t,name:!1,props:e.attributes})}break;case"video":case"audio":if(o.controls=!t.controls||t.controls,o.children=[],t.sources&&"object"==typeof t.sources){for(const e of t.sources)o.children.push({tag:"source",name:!1,props:e});if(t.subtitles&&"object"==typeof t.subtitles)for(const e of t.subtitles)o.children.push({tag:"track",name:!1,props:e})}else if(t.children&&t.children.length)for(const e of t.children){const t=e.tagName.toLowerCase();"source"==t&&"track"==t&&o.children.push({tag:t,name:!1,props:e.attributes})}break;case"iframe":if(!o.src)return null;break;default:e="div",s="custom-element"}return{tag:e,name:s,props:o}}prepare(t){const e=[];if(t&&"object"==typeof t&&t.length)for(const s of t)if("object"==typeof s&&s.nodeType){const t=this.data(!0),o=s.dataset;if(Object.assign(t,o),t.ref=s,o.sources)try{t.sources=JSON.parse(o.sources)}catch{}if(s.href)t.src=s.href;else if(o.href)t.src=o.href;else if(/iframe|img|picture|video|audio/i.test(s.nodeName)){const e=s.nodeName.toLowerCase();/img|picture/.test(e)?t.type="image":t.type=e,"iframe"!=e&&s.children&&s.children.length&&(t.children=s.children)}else t.type="element",t.node=s;e.push(t)}else"string"==typeof s?e.push(s):"type"in s&&/(^element|iframe|image|video|audio|pdf)/.test(s.type)?e.push(this.data(s)):e.push(this.data(!0));return e}modus(t){if(!this.data().isData(t)){const e=this.prepare([t]);t=this.content(e[0])}return t.$?t:null}add(t){const e=modus(t);e&&(this.contents.push(e),this.$.append(e.$)),this.options.controls&&this.controls()}remove(t){const e=modus(t);if(e){const t=this.contents.indexOf(e);-1!=t&&(this.contents.splice(t,1),this.$.remove(e.$))}this.options.controls&&this.controls()}prev(t){this.event().prevent(t),this.step(-1),this.event().blur(t)}next(t){this.event().prevent(t),this.step(1),this.event().blur(t)}route(t,e){this[(e="rtl"==this.dir?!(e>0):e>0)?"next":"prev"](t)}step(t){const{options:e,abs:s,contents:o}=this;0===t&&(this.current=this.current||o[0],this.index=this.index||0);let{index:n,current:i}=this;const r=o.length;if(!e.onStep.call(this,this,i,t)){if(0==r)return;if(!e.infinite&&0!=s&&s===t)return}if(0!=t){n=(-1===t?o[n-1]:o[n+1])?-1===t?n-1:n+1:-1===t?r-1:0}this.slide(n)}slide(t){const{options:e,contents:s}=this,o=s.length;let n=this.current,i=s[t],r=n!=i;if(0!=o&&i){if(r&&n.unload("inner"),!e.infinite){let t=0;i.$.previous?i.$.next||(t=1):t=-1,this.abs=t,e.controls&&this.controls(t)}i.render("inner"),i.$.append(i.inner),e.onSlide.call(this,this,i,n),r&&n.$.remove(n.inner),this.index=t,this.current=i,e.caption&&this.caption()}}controls(t){const{options:e,nav:s}=this;if(this.contents.length>1){if(s.$.show(),!e.infinite&&void 0!==t){const{prev:e,next:o}=s;switch(t){case-1:e.disable(),o.enable();break;case 1:e.enable(),o.disable();break;default:e.enable(),o.enable()}}}else s.$.hide()}caption(t){const{options:e,heading:s,current:o}=this;if(s.$.empty(),t=t??o.caption,!e.onCaption.call(this,this,o,t)&&t){t=t.split(/\n{2}/g);for(const e of t){const t=this.compo("p",!1,{innerText:e});s.$.append(t)}}}arrows(){const{options:t,nav:e}=this,{icons:s,locale:o}=t;e.$.empty();for(let n=0;n<2;n++){const i="prev",r="next",c=n?r:i,a=s.autoDir&&"rtl"==this.dir?n?i:r:c,h=e[c]=this.compo("button",["button",c],{onclick:t[c].trigger,innerText:"text"==s.type?t[a].text:"",ariaLabel:o[c]});if("text"!=t.icons){const{type:e,prefix:o,src:n,viewBox:i}=s,{icon:r,viewBox:l}=t[a],d=this.icon(e,"font"==e?r:c,o,n??r,r??a,l??i),u=d.first;u.setAttr("stroke","currentColor"),u.setAttr("stroke-width","2px"),h.append(d)}e.$.append(h)}}pointers(){const t=this;let e=0,s=0,o=0;return{hit(t){const n=t.changedTouches,i=n?n[0]:t;e=t.timeStamp,s=i.screenX,o=i.screenY},drop(n){const i=n.changedTouches,r=i?i[0]:n,c=r.screenX-s,a=r.screenY-o,h=Math.abs(c/a),l=Math.abs(a/c);if(!i){if(n.timeStamp-e<100)return}if(Math.abs(h>l?c:a)<45)return;h>l&&t.route(n,c>=0?-1:1)},nil(t){o=s=e=0}}}keyboard(t){super.keyboard(t);const p=()=>this.event().prevent(t);switch(t.keyCode){case 37:p(),this.route(t,-1);break;case 39:p(),this.route(t,1)}if(this.options.autoHide){const t=this.modal.$,e="modal-autohide";t.classList.remove(e),this.delay((()=>t.classList.add(e)))}}get dir(){return document.dir}},t.Modal=Modal}(this.ensemble=this.ensemble||{});