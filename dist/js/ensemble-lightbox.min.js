/*!
 * ensemble Lightbox
 * @version 0.0.4
 * @link https://github.com/loltgt/ensemble-lightbox
 * @copyright Copyright (C) Leonardo Laureti
 * @license MIT License
 */
!function(t){"use strict";class locale{constructor(t){return"object"==typeof locale[t]?locale[t]:locale[0]}static defaults(){return Object.fromEntries(["EBADH","ETAGN","EPROP","EMTAG","EOPTS","EELEM","EMETH","DOM"].map((t=>[t,t])))}}const e=locale.defaults(),s="html|head|body|meta|link|style|script";class part{render(){delete this.element,delete this.render}bind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.appendChild(s)}unbind(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.removeChild(s)}place(t,e){const s=this[this.ns];return"function"==typeof e&&e.call(this,s),!!t.replaceWith(s)}append(t){const e=this.ns;return!!this[e].appendChild(t[e])}prepend(t){const e=this.ns;return!!this[e].prependChild(t[e])}remove(t){const e=this.ns;return!!this[e].removeChild(t[e])}fill(t){if(!t instanceof Element||RegExp(s,"i").test(t.tagName)||RegExp(`(<(${s})*>)`,"i").test(t.innerHTML))throw new Error(e.EMTAG);return this.empty(),!!this[this.ns].appendChild(t)}empty(){for(;this.first;)this.remove(this.first)}get children(){return Array.prototype.map.call(this[this.ns].children,(t=>t._1))}get first(){const t=this[this.ns];return t.firstElementChild?t.firstElementChild._1:null}get last(){const t=this[this.ns];return t.lastElementChild?t.lastElementChild._1:null}}class Compo extends part{constructor(t,s,n,i,o,r){if(!new.target)throw e.EBADH;super();const a=this.ns="_"+t,c=s?s.toString():"div";if(RegExp("html|head|body|meta|link|style|script","i").test(c))throw new Error(e.ETAGN);const h=this[a]=this.element(t,c,n,i,o,r);if(this.__Compo=!0,this[a]._1=this,i&&"object"==typeof i)for(const s in i){const n=s.toString();if(RegExp("attributes|classList|innerHTML|outerHTML|nodeName|nodeType").test(n))throw new Error(e.EPROP);if(0===n.indexOf("on")&&i[n]&&"function"==typeof i[n])h[n]=i[n].bind(this);else if("object"!=typeof i[n])h[n]=i[n];else if("children"==n&&"object"==typeof i[n]&&i[n].length)for(const e of i.children){const s=e.tag,n=e.name,i=e.props;this.append(new Compo(t,s,n,i))}}if(n){const e=h.className;h.className="","string"==typeof n?h.className=t+"-"+n:"object"==typeof n&&(h.className=Object.values(n).map((e=>t+"-"+e)).join(" ")),e&&(h.className+=" "+e)}this.render()}element(t,e,s,n,i,o){return o?document.createElementNS(e,[...o,...i]):document.createElement(e,i)}hasAttr(t){return this[this.ns].hasAttribute(t)}getAttr(t){return this[this.ns].getAttribute(t)}setAttr(t,e){this[this.ns].setAttribute(t,e)}delAttr(t){this[this.ns].removeAttribute(t)}getStyle(t){return window.getComputedStyle(this[this.ns])[t]}show(){this[this.ns].hidden=!1}hide(){this[this.ns].hidden=!0}enable(){this[this.ns].disabled=!1}disable(){this[this.ns].disabled=!0}get node(){return console.warn(e.DOM),this[this.ns]}get parent(){const t=this[this.ns];return t.parentElement&&"_1"in t.parentElement?t.parentElement._1:null}get previous(){const t=this[this.ns];return t.previousElementSibling?t.previousElementSibling._1:null}get next(){const t=this[this.ns];return t.nextElementSibling?t.nextElementSibling._1:null}get classList(){return this[this.ns].classList}static isCompo(t){return t instanceof Compo}}class Data{constructor(t,s){if(!new.target)throw e.EBADH;s&&"object"==typeof s&&Object.assign(this,{},s);const n=this.ns="_"+t;this.__Data=!1,this[n]={ns:t}}compo(t,e,s,n=!1,i=!1,o=!1){const r=this[this.ns].ns;let a;return a=n?{ns:r,tag:t,name:e,props:s,load:i,unload:o}:new Compo(r,t,e,s),i&&"function"==typeof i&&(a.load=s.onload=i),o&&"function"==typeof o&&(a.unload=s.onunload=o),a}async render(t){const e=this[this.ns],s=this;e[t]&&e[t]._||(e[t]={_:s[t],load:s[t].load,unload:s[t].unload},s[t]=new Compo(s[t].ns,s[t].tag,s[t].name,s[t].props)),e[t].load()}async unload(t){const e=this[this.ns];e[t]&&e[t]._&&e[t].unload()}async reflow(t,e){const s=this[this.ns];e?s[t]=this.compo(s[t]._.ns,s[t]._.name,s[t]._.props):s[t]&&s[t]._&&s[t].load()}static isData(t){return t instanceof Data}}class Event{constructor(t,s,n){if(!new.target)throw e.EBADH;const i=this.ns="_"+t;n=(Compo.isCompo(n)?n[t]:n)||document,this.__Event=!1,this[i]={name:s,node:n}}add(t,e=!1){const{node:s,name:n}=this[this.ns];s.addEventListener(n,t,e)}remove(t){const{node:e,name:s}=this[this.ns];e.removeEventListener(s,t)}static isEvent(t){return t instanceof Event}}class base{constructor(){const t=arguments;let s,n;if(t.length>1?(s=t[0],n=t[1]):n=t[0],n&&"object"!=typeof n)throw new TypeError(e.EOPTS);if(s&&"object"!=typeof s)throw new TypeError(e.EELEM);this.binds(),this.options=this.opts(this.defaults(),n),Object.freeze(this.options),this.element=s}opts(t,e){const s={};for(const n in t)null!=t[n]&&"object"==typeof t[n]?s[n]=Object.assign(t[n],e[n]):s[n]=void 0!==e[n]?e[n]:t[n];return s}compo(t,e,s){const n=this.options.ns;return null!=t?new Compo(n,t,e,s):Compo}data(t){const e=this.options.ns;return null!=t?new Data(e,t):Data}event(t,e){return"string"==typeof t?new Event(this.options.ns,t,e):t?(t.preventDefault(),void t.target.blur()):Event}selector(t,e,s=!1){return e=e||document,s?e.querySelectorAll(t):e.querySelector(t)}appendNode(t,e){return!!t.appendChild(e)}prependNode(t,e){return!!t.prependChild(e)}removeNode(t,e){return!!t.removeChild(e)}cloneNode(t,e=!1){return t.cloneNode(e)}hasAttr(t,e){return t.hasAttribute(e)}getAttr(t,e){return t.getAttribute(e)}setAttr(t,e,s){t.setAttribute(e,s)}delAttr(t,e){t.removeAttribute(e)}styleTime(t,e){let s=Compo.isCompo(t)?t.getStyle(e):window.getComputedStyle(t)[e];return s&&(s=s.indexOf("s")?1e3*parseFloat(s):parseInt(s)),s||0}wrap(t){const s=this;if(this[t]&&"function"!=typeof t)throw new TypeError(e.EMETH);return function(e){t.call(s,e,this)}}delay(t,e,s){const n=e?this.styleTime(e,"transitionDuration"):0;setTimeout(t,n||s)}}class Modal extends base{defaults(){return{ns:"modal",root:"body",className:"modal",effects:!0,windowed:!1,clone:!0,backdrop:!0,keyboard:!0,close:{onclick:this.close,innerText:"Ã—",ariaLabel:"Close"},onOpen:function(){},onClose:function(){},onShow:function(){},onHide:function(){},onContent:function(){}}}binds(){this.open=this.wrap(this.open),this.close=this.wrap(this.close),this.backdrop=this.wrap(this.backdrop),this.keyboard=this.wrap(this.keyboard)}constructor(){if(!new.target)throw"Bad invocation. Must be called with `new`.";super(...arguments)}generator(){const t=this.options,e=this.modal=this.data({onclick:!1}),s=this.modal.$=this.compo("dialog",!1,{className:"object"==typeof t.className?Object.values(t.className).join(" "):t.className,hidden:!0,onclick:function(){e.onclick&&"function"==typeof e.onclick&&e.onclick.apply(this,arguments)}}),n=this.stage=this.compo(!1,"content"),i=this.compo("button",["button","close"],t.close);s.append(n),t.windowed?(s.classList.add(t.ns+"-windowed"),n.append(i)):s.append(i),t.backdrop&&(e.onclick=this.backdrop),t.effects&&s.classList.add(t.ns+"-effects"),this.root=this.selector(t.root),this.built=!0}populate(t){const e=this.element;if(!e)return;const s=this.content(e);this.stage.append(s)}resume(t){}content(t,e){const s=this.options,n=this.compo(!1,"object");let i=(e=void 0!==e?e:s.clone)?this.cloneNode(t,!0):t;return s.onContent.call(this,this,n,i),i&&n.fill(i),n}destroy(){const t=this.root,e=this.modal.$;this.removeNode(t,e),this.built=!1}open(t,e){if(this.event(t),this.opened)return;const s=this.options;this.built?this.resume(e):(this.generator(),this.populate(e)),this.opened=!0,s.onOpen.call(this,this,e,t),this.show(e),s.keyboard&&this.event("keydown").add(this.keyboard)}close(t,e){if(this.event(t),!this.opened)return;const s=this.options;this.opened=!1,s.onClose.call(this,this,e,t),this.hide(e),s.keyboard&&this.event("keydown").remove(this.keyboard)}show(t){const e=this.options,s=this.root;this.modal;const n=this.modal.$;n.bind(s),this.delay((function(){n.show(),e.onShow.call(self,self,t)}))}hide(t){const e=this.options,s=this.root;this.modal;const n=this.modal.$;n.hide(),this.delay((function(){n.unbind(s),e.onHide.call(self,self,t)}),n,300)}backdrop(t){this.event(t);const e=t.target,s=e.parentElement,n=this.options.ns;var i;if(((i=new RegExp(n+"-content")).test(e.className)||i.test(s.className))&&this.close(t),!(i=new RegExp(n+"-object")).test(e.className))return;const o=e.firstElementChild,r=o.offsetWidth,a=o.offsetHeight,c=e.offsetTop,h=e.offsetLeft,l=e.offsetWidth,p=e.offsetHeight,d=t.x,u=t.y,f=(p-a)/2,m=(l-r)/2;(u>c||d>h||d<l||u<p)&&(u<f||d>m+r||u>f+a||d<m)&&this.close(t)}keyboard(t){if(this.event(t),27===t.keyCode)this.close(t)}}t.Lightbox=class Lightbox extends Modal{defaults(){return Object.assign(super.defaults(),{className:["modal","modal-lightbox"],selector:"",contents:null,backdrop:!1,navigation:!0,captions:!0,infinite:!0,autoDiscover:!0,autoHide:"navigation",overlay:!1,checkOrigin:!0,prev:{onclick:this.prev,innerText:"<",ariaLabel:"Previous"},next:{onclick:this.next,innerText:">",ariaLabel:"Next"},onStep:function(){},onSlide:function(){},onCaption:function(){}})}binds(){super.binds(),this.add=this.wrap(this.add),this.remove=this.wrap(this.remove),this.prev=this.wrap(this.prev),this.next=this.wrap(this.next)}constructor(){if(!new.target)throw"Bad invocation. Must be called with `new`.";super(...arguments)}generator(){super.generator();const t=this.modal.$,e=this.stage,s=this.options,n=this.gallery=this.compo(!1,"gallery");if(e.append(n),s.navigation){var i=this.nav=this.data(!0);const t=i.$=this.compo(!1,"nav"),e=i.prev=this.compo("button",["button","prev"],s.prev),n=i.next=this.compo("button",["button","next"],s.next);t.append(e),t.append(n)}if(s.captions){var o=this.captions=this.data(!0);o.$=this.compo(!1,"captions")}if(s.overlay){const e=s.overlay.toString().match(/captions|navigation/);t.classList.add(s.ns+"-overlay"),e&&t.classList.add(s.ns+"-overlay-"+e[0])}if(s.autoHide){const e=s.autoHide.toString().match(/captions|navigation/);t.classList.add(s.ns+"-autohide"),e&&t.classList.add(s.ns+"-autohide-"+e[0])}s.windowed?(s.navigation&&e.append(i.$),s.captions&&e.append(o.$)):(s.navigation&&t.append(i.$),s.captions&&t.append(o.$))}populate(t){const e=this.options,s=this.element;let n;e.contents&&"object"==typeof e.contents?n=e.contents:e.selector&&s&&(n=this.selector(e.selector,s,!0)),n=this.contents=this.prepare(n);for(const e of n){const s=this.content(e);t&&t===s.ref&&(this.index=n.indexOf(s),this.current=s),this.add(s)}this.current=this.current||n[0],this.index=this.index||0,this.slide(0),e.navigation&&this.navigation(),e.captions&&this.caption()}resume(t){const e=this.options,s=this.contents;for(const e of s)e.$.hide(),t&&t===e.ref&&(this.index=s.indexOf(e),this.current=e);this.current=this.current||s[0],this.index=this.index||0,this.slide(0),e.navigation&&this.navigation(),e.captions&&this.caption()}content(t,e){const s=this.options,n=this.compo(!1,"object");var i;n.hide();const o=(i="string"==typeof t?this.data({src:t}):t).src,r=i.type;let a=i.type;a&&(a=a.match(/(^image|video|audio)|(pdf$)/),a=a?a[0]:"");const c=/^https?:\/\//.test(o);let h,l=!1;if(s.autoDiscover&&o&&!a&&(/\.jpg|\.jpeg|\.png|\.apng|\.gif|\.webp|\.avif|\.bmp|\.svg$/i.test(o)?a="image":/\.pdf$/.test(o)?a="pdf":/\.mp4|\.webm|\.ogv|\.m4v|\.hevc|\.ivf|\.obu|\.ismv|\.mkv$/i.test(o)?a="video":/\.mp3|\.opus|\.ogg|\.m4a|\.aac|\.flac|\.wav|\.weba|\.mka$/i.test(o)?a="audio":/^data:image\/jpeg|png|apng|gif|webp|avif|bmp|svg\+xml/.test(o)&&(l=!0,a="image")),"pdf"==a&&(a="iframe",h="pdf"),s.checkOrigin&&o&&c&&!l){("null"!=window.origin?window.origin:window.location.origin)!=new URL(o).origin&&(a="")}if(o&&!a)if("#"==o[0]){const t=this.selector(o);t&&(i.node=t,a=/iframe|img|picture|video|audio/i.test(t.nodeName)?/img|picture/i.test(t.nodeName)?"image":t.nodeName.toLowerCase():"element")}else a="iframe";"element"==a&&(e=void 0!==e?e:s.clone,i.node=e?this.cloneNode(i.node,!0):i.node),h||r==a||(h=r),i.ref=i.ref||null,i.type=a,i.src=o,s.onContent.call(this,this,i),a&&n.classList.add(s.ns+"-"+a),h&&n.classList.add(s.ns+"-"+h);const p=this.inner(i);return i.load=function(){i.node&&i.inner.fill(i.node),i.$.show()},i.unload=function(){i.node&&i.inner.empty(),i.$.hide()},i.$=n,i.inner=i.compo(p.tag,p.name,p.props,!0,i.load,i.unload),i}inner(t){let e=t.type,s=!0,n={};for(const e in t)/ref|src|type|sources|subtitles|children/.test(e)||"_"==e[0]||(n[e]=t[e]);switch(t.src&&(n.src=t.src),t.type){case"image":if(e="img",t.sources||t.children)if(e="picture",n.children=[],t.sources&&"object"==typeof t.source)for(const e of t.sources)n.children.push({tag:"source",name:!0,props:e});else if(t.children&&t.children.length)for(const e of t.children){const t=e.tagName.toLowerCase();"source"==t&&"img"==t&&n.children.push({tag:t,name:!0,props:e.attributes})}break;case"video":case"audio":if(n.controls=!t.controls||t.controls,n.children=[],t.sources&&"object"==typeof t.sources){for(const e of t.sources)n.children.push({tag:"source",name:!0,props:e});if(t.subtitles&&"object"==typeof t.subtitles)for(const e of t.subtitles)n.children.push({tag:"track",name:!0,props:e})}else if(t.children&&t.children.length)for(const e of t.children){const t=e.tagName.toLowerCase();"source"==t&&"track"==t&&n.children.push({tag:t,name:!0,props:e.attributes})}break;case"iframe":if(!n.src)return null;break;default:e="div",s="custom-element"}return{tag:e,name:s,props:n}}prepare(t){const e=[];if(t&&"object"==typeof t&&t.length)for(const s of t)if("object"==typeof s&&"nodeName"in s){const t=this.data(!0),n=s.dataset;if(Object.assign(t,n),t.ref=s,n.sources)try{t.sources=JSON.parse(n.sources)}catch{}if(s.href)t.src=s.href;else if(n.href)t.src=n.href;else if(/iframe|img|picture|video|audio/i.test(s.nodeName)){const e=s.nodeName.toLowerCase();/img|picture/.test(e)?t.type="image":t.type=e,"iframe"!=e&&s.children&&s.children.length&&(t.children=s.children)}else t.type="element",t.node=s;n.caption&&(t.caption=n.caption),e.push(t)}else"string"==typeof s?e.push(s):"type"in s&&/(^element|iframe|image|video|audio|pdf)/.test(s.type)?e.push(this.data(s)):e.push(this.data(!0));return e}add(t){this.gallery.append(t.$),this.options.navigation&&this.navigation()}remove(t){this.gallery.remove(t.$),this.options.navigation&&this.navigation()}prev(t){this.event(t),this.slide(-1)}next(t){this.event(t),this.slide(1)}slide(t){const e=this.options;if(!e.infinite&&0!=this.stepper&&this.stepper===t)return;const s=this.contents;let n=this.index,i=this.current,o=i;if(e.onStep.call(this,this,i,t),0!=t){const e=s.length-1,r=-1===t?s[n-1]:s[n+1],a=-1===t?s[e]:s[0];o=r||a,n=r?-1===t?n-1:n+1:-1===t?e:0,i.unload("inner")}if(!e.infinite){let t=0;o.$.previous?o.$.next||(t=1):t=-1,this.stepper=parseInt(t),e.navigation&&this.navigation(t)}o.render("inner"),o.$.append(o.inner),e.onSlide.call(this,this,i,t,i.$!=o.$?o.$:null),this.delay((function(){0!=t&&i.$.remove(i.inner)}),i.$),this.index=n,this.current=s[n],e.captions&&this.caption()}navigation(t){const e=this.nav;if(this.contents.length>1){if(e.$.show(),!this.options.infinite&&void 0!==t)switch(t){case-1:e.prev.disable(),e.next.enable();break;case 1:e.prev.enable(),e.next.disable();break;default:e.prev.enable(),e.next.enable()}}else e.$.hide()}caption(t){const e=this.options,s=this.captions,n=this.current;if(s.$.empty(),!e.onCaption(this,this,n,t)){if(!t)if(n.caption)t=n.caption;else if(e.selector){const e=n.ref;if(this.hasAttr(e,"title"))t=this.getAttr(e,"title");else if("image"==n.type){t=this.selector("img",e).alt}}if(t){t=t.split(/\n\n|\r\n\r\n/);for(const e of t){const t=this.compo("p",!1,{innerText:e});s.$.append(t)}}}}keyboard(t){switch(super.keyboard(t),t.keyCode){case 37:this.prev(t);break;case 39:this.next(t)}}},t.Modal=Modal}(this.ensemble=this.ensemble||{});